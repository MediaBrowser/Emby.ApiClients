// <copyright file="EmbyApiKeyAuthenticator.cs" company="Emby LLC">
// Emby.ApiClient. Autogenerated Code. No license applied. 
// </copyright>

namespace Emby.ApiClient.Client.Authentication
{
    using RestSharp;
    using RestSharp.Authenticators;
    using System;
    using System.Threading.Tasks;

    /// <summary>
    /// Emby API Key Authenticator.
    /// </summary>
    /// <remarks>See https://dev.emby.media/doc/restapi/API-Key-Authentication.html.</remarks>
    public class EmbyApiKeyAuthenticator : IEmbyAuthenticator
    {
        public EmbyApiKeyAuthenticator(string apiKey)
        {
            if (string.IsNullOrWhiteSpace(apiKey))
            {
                throw new ArgumentException("Value cannot be null or whitespace.", nameof(apiKey));
            }

            this.ApiKey = apiKey;
        }

        public string ApiKey { get; }

        protected virtual ValueTask<Parameter> GetAuthenticationParameter()
        {
            var paramter = new HeaderParameter("X-Emby-Token", this.ApiKey);

            return new ValueTask<Parameter>(paramter);
        }

        public virtual async ValueTask Authenticate(IRestClient client, RestRequest request)
        {
            request.AddOrUpdateParameter(await this.GetAuthenticationParameter().ConfigureAwait(false));
        }
    }
}
